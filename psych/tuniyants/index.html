<html>
    <head>
        <title>ОПРОСНИК ГЕНДЕРНОЙ ИДЕНТИЧНОСТИ</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
        <script>
            // (B) ENCRYPT & DECRYPT FUNCTIONS
            var crypt = {
            // (B1) THE SECRET KEY
            secret : "CIPHERKEY",
            
            // (B2) ENCRYPT
            encrypt : function (clear) {
                var cipher = CryptoJS.AES.encrypt(clear, crypt.secret);
                cipher = cipher.toString();
                return cipher;
            },
            
            // (B3) DECRYPT
            decrypt : function (cipher) {
                var decipher = CryptoJS.AES.decrypt(cipher, crypt.secret);
                decipher = decipher.toString(CryptoJS.enc.Utf8);
                return decipher;
            }
            };

            function checkData(){
                // name is not empty
                if(document.getElementById("name").value == ''){
                    console.log('name');
                    return false;
                }
                // age is not empty
                if(document.getElementById("age").value == '' || isNaN(document.getElementById("age").value)){
                    console.log('age');
                    return false;
                }
                // marital status
                // kids
                if (!(document.getElementById("kids-yes").checked || document.getElementById("kids-no").checked)){
                    console.log('kids');
                    return false;
                }
                return true;
            }

            function nextStep(){
                // check if form is filled properly
                if(!checkData()){
                    document.getElementById('error-message').innerHTML = 'Пожалуйста, заполните все поля!';
                    return;
                }
                // collect data, put into structure
                var dict = {};
                dict['name'] = document.getElementById("name").value;
                dict['age'] = document.getElementById("age").value;
                dict['status'] = document.getElementById("marital-status").value;
                dict['children'] = document.getElementById("kids-yes").checked;
                // convert structure into string
                plaintext = JSON.stringify(dict);
                // encript the string
                var ciphertext = crypt.encrypt(plaintext);
                // go to next page
                window.location.replace('./part1.html?data='+encodeURIComponent(ciphertext));
            }
        </script>
    </head>
    <body>
        <center>
            <h3>Кафедра психологии МГУ им. М.В. Ломоносова в г. Ташкенте</h3>
            <h1>ОПРОСНИК ГЕНДЕРНОЙ ИДЕНТИЧНОСТИ</h1>
             <h3>Мужской вариант</h3>
        </center> 
        <div style="width: 75%; margin: auto;">
        Ответив на набор предложенных вопросов, вы получите количественное отображение своих представлений о категориях «мужское» и «женское» и тех качествах, которые в обществе считаются мужскими и женскими.<br>
        Очень важно, чтобы вы отвечали серьезно и искренне, только в этом случае результаты будут действительно информативны! Если вы возникнут сомнения, что выбрать, доверьтесь своему первому впечатлению. 
        </div>
        <div style="width: 75%; margin: auto; border:1pt;">
            <!-- personal info -->
            <h3>Пожалуйста, укажите информацию о себе:</h3>
            Имя/Фамилия/Псевдоним <input type="text" id="name" name="name"><br>
            Возраст <input type="text" id="age" name="age"><br>
            Семейное положение <select name="marital-status" id="marital-status">
                <option value="married">Женат</option>
                <option value="single">Холост</option>
                <option value="divorced">Разведен</option>
                <option value="widower">Вдовец</option>
              </select><br>
            Есть ли дети <input type="radio" id="kids-yes" name="children" value="yes">
            <label for="radio-yes">Да</label>
            <input type="radio" id="kids-no" name="children" value="no">
            <label for="radio-no">Нет</label><br>
            <center>
                <br><br>
                Опросник состоит из 5 небольших частей. Для корректной обработки данных обязательно заполнить его целиком.<br><br>
                <button onclick="nextStep();">Начать тест</button><br><br>
                <span id='error-message' style="color: red;"></span>
            </center>
        </div>
    </body>
</html>
